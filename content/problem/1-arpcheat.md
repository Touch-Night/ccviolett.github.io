ARP 欺骗攻击

### 题目描述

众所周知，计算机网络中，每个设备有一个唯一且固定的 MAC 地址、一个可能动态变化的 IP 地址和一个将 IP 映射为 MAC 地址的 ARP 表。

当知道某台设备的 MAC 地址时，就可以直接与其通信，否则就需要通过 ARP 协议获取 MAC 地址。

我们假设主机 A 的 IP 地址为`192.168.1.1`，MAC 地址为`0A-11-22-33-44-01`；主机 B 的 IP 地址为`192.168.1.2`，MAC 地址为`0A-11-22-33-44-02`。

当主机 A 要与主机 B 通信时，地址解析协议可以将主机 B 的 IP 地址（192.168.1.2）解析成主机 B 的 MAC 地址，以下为工作流程：

1. 主机 A 在 ARP表中查找主机B的 IP 所匹配 MAC 地址。
2. 如果没有找到映射，主机 A 将向网络中所有主机发送 ARP 请求，数据包中包含 A 的 MAC 地址与询问的 IP(192.168.1.2)。
3. 主机 B 收到请求后发现与询问 IP 与自身 IP 匹配，于是直接向 A 发送 ARP 应答，数据包包含 B 的 MAC 地址。同时将 A 的 MAC 地址添加到自身的 ARP 表中。
4. 主机 A 收到从主机 B 发来的 ARP 应答，更新 ARP 表后，发送要传输的数据。