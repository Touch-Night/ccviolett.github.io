+++ 
draft = false
date = 2022-03-01T10:22:18+08:00
title = "如何运用群论计算本质不同的方案数？"
description = ""
slug = ""
authors = ["ccviolett"]
tags = ["算法", "信息竞赛"]
categories = []
externalLink = ""
series = []
+++

### 零、群

定义：$(S, .)$ 由集合 S 和操作 . 构成群。

一个群需要满足以下的四个性质：

- 封闭性

    群中的任意两个元素进行运算之后得到的结果，还是群中的元素。

- 结合律

    任意两个元素先运算或后运算不影响最终结果。

- 单位元

    群中存在元素，其他元素与其进行运算后不变。

- 逆元

    对于群中的任意一个元素，都存在一个元素与其运算后得到单位元。

构造的置换满足群的性质才能使用 Burnside 引理和 Polya 定理。

### 一、Burnside 引理

$$
本质不同的方案数 = \frac{1}{置换数} \sum_{每一种置换} 在当前置换下等价的方案数
$$

难点在于**求每种置换下等价的方案数**，以及**化简式子**。

### 二、Polya 定理

$$
本质不同的方案数 = \frac{1}{置换数} \sum_{每一种置换} 颜色数量^{该置换中环的数量}
$$

难点在于**求每种置换中环的数量**，以及**化简式子**。

> **Tips: 环**
> - 一个置换中环的数量，就是将置换进行无数次也不会互相影响的部分数量。
> - 如 (1 -> 2 -> 3 -> 4 -> 1) 是一个环，(1 -> 3 -> 1)(2 -> 4 -> 2) 是两个环，(1 -> 1)(2 -> 3 -> 2)(4 -> 4) 是三个环。

### 三、例题

1. 给一个 n 个点的环染 m 种颜色，问有多少种本质不同的染色方案。定义本质相同的方案可以通过旋转得到。

    - 置换数：n 种旋转（旋转 0 到 n - 1 个）
    - 颜色数量：m 种
    - 每种置换中环的数量：旋转 k 个会产生 gcd(k, n) 个环
    - 本质不同的方案数：$res = \frac{1}{n}\sum_{i = 1}^{n} m^{gcd(i, n)}$

2. 给一个 n 行 n 列的格染 m 种颜色，问有多少种本质不同的染色方案。定义本质相同的方案可以通过旋转、翻转得到。

    - 置换数：4 种旋转（转 0 度、转 90 度、180 度、270 度）、2 种翻转（水平翻转、垂直翻转）、2 种（水平翻转+转 90 度、水平翻转+转270 度）
    - 颜色数量：m 种
    - 每种置换中环的数量：
      - 转 0 度有 $n^2$ 个
      - 转 90 度、 270 度和水平+转 90 度、270 度有 $\frac{n^2}{4}$ 个
      - 转 180 度、水平翻转、垂直翻转有 $\frac{n^2}{2}$ 个
    - 本质不同的方案数：$res = \frac{1}{6}(4m^{\frac{n^2}{4}} + 3m^{\frac{n^2}{2}} + m^{n^2})$

3. 给一个 n 阶的魔方染 m 种颜色，问有多少种本质不同的染色方案。定义本质相同的方案可以通过旋转得到。

    - 置换数：横向转 90 度与竖向转 90 度组合
    - 颜色数量：m 种
    - 每种置换中环的数量：每一种组合独立计算
    - 本质不同的方案数：套用公式即可

4. 给 n 张牌染色 m 种颜色，给定 k 种洗牌方法，问有多少种本质不同的染色方案。定义本质相同的方案可以通过洗牌得到。

    给定了置换数，暴力计算每种置换中环的数量即可。

5. 给 n 张牌染上 3 种颜色，其中要求每种颜色有 $s_i$ 张，给定 k 种洗牌方法，问有多少种本质不同的染色方案。定义本质相同的方案可以通过洗牌得到。

    和上一题不同的地方在于，这里的染色不是自由的，所以不能直接使用 Polya 去做，只能用 Burnside。我们需要用 DP 去计算满足染色限制的条件下，置换后等价的方案数。

题目链接：[P4980 【模板】Polya 定理](https://www.luogu.com.cn/problem/P4980)，具体定理的证明可以在题解中自行查阅。